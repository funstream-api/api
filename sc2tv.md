Работа с методами Sc2tv 
=======================

Для использования методов доната необходимо авторизация на sc2tv.  
Разрешение на использование методов доната привязывается к конкретному пользователю.

1. Выполняется проверка на разрешение использование методов доната [`/api/sc2tv/check`](#Проверить-права)
2. Если разрешения нет, то запрашивается урл для авторизации [`/api/sc2tv/authUrl`](#Получить-урл-авторизации)
3. Пользователь открывает полученный урл в браузере и разрешает приложению использование методов доната(требуется аутентификация на sc2tv)
4. Приложение делает запрос на проверку разрешения от пользователя [`/api/sc2tv/check`](#Проверить-права)
5. Если разрешение получено, то методы доната становятся доступны, иначе повторить с 2


API связи с sc2tv
------------------
1. [**Авторизация**](#Авторизация)
    - [`POST` `A` `/api/sc2tv/authUrl` Получить урл авторизации](#Получить-урл-авторизации)
    - [`POST` `A` `/api/sc2tv/check` Проверить права](#Проверить-права)
2. [**Донат**](#Донат)
    - [`POST` `A` `/api/sc2tv/donate` Донат произвольной суммы](#Донат-произвольной-суммы)
    - [`POST` `A` `/api/sc2tv/donate/fast` Микродонат](#Микродонат)


## Авторизация

Рекомендуется вызывать только если функция доната вернула ошибку авторизации.


#### Получить урл авторизации
##### [`POST` `A` `/api/sc2tv/authUrl`](https://funstream.tv/api/sc2tv/authUrl)
**запрос**
```js
{}
```
**ответ**
```js
{
    url: <string> // Урл авторизации на сайте sc2tv
}
```
*Вернёт ошибку если пользователь не залогинен или передан неверный токен.*


####  Проверить права
##### [`POST` `A` `/api/sc2tv/check`](https://funstream.tv/api/sc2tv/check)
**запрос**
```js
{}
```
**ответ**
```js
{
    result: <bool> // true если доступ разрешен
}
```
*Вернёт ошибку если пользователь не залогинен, передан неверный токен или сайт sc2tv.ru в данный момент недоступен.*


## Донат

#### Донат произвольной суммы
##### [`POST` `S` `/api/sc2tv/donate`](https://funstream.tv/api/sc2tv/donate)
**запрос**
```js
{
    streamerId: <int>, // Идентификатор пользователя получателя
    amount: <float> // Сумма
}
```
**ответ**
```js
[]
```
*Вернёт ошибку если пользователь не залогинен или передан неверный токен.*  
*Вернёт ошибку от sc2tv если пользователь не авторизован, у него недостаточно пекоинов на счету или получатель не является стримером.*


#### Микродонат
##### [`POST` `A` `/api/sc2tv/donate/fast`](https://funstream.tv/api/sc2tv/donate/fast)

Значок доллара на сайте. Переводит фиксированную минимально возможную сумму(10 пекоинов).

**запрос**
```js
{
    streamerId: <int>, // Идентификатор пользователя
}
```
**ответ**
```js
[]
```
*Вернёт ошибку если пользователь не залогинен или передан неверный токен.*  
*Вернёт ошибку от sc2tv если пользователь не авторизован, у него недостаточно пекоинов на счету или получатель не является стримером.*
